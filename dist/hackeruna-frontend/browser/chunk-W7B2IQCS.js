import{$ as ie,B as X,G as ee,Ha as oe,I as te,Ib as x,K as A,L as ne,M as se,Ma as E,Oa as ce,P as S,Q as re,Qa as le,S as g,Ta as ue,U as p,Ua as de,V as f,Va as fe,W as b,_ as F,a as d,b as y,c as q,eb as he,g as U,ha as w,j as J,k as W,l as Y,m as N,n as R,oa as ae,ob as ge,r as m,s as Z,w as I,y as Q}from"./chunk-XLADJG7K.js";function D(t){t||(F(D),t=f(w));let a=new U(e=>t.onDestroy(e.next.bind(e)));return e=>e.pipe(ne(a))}function pe(t){return typeof t=="function"}function v(t){return typeof t=="string"}function C(t){return!!t&&typeof t=="object"&&!Array.isArray(t)}function j(t){return t==null}function $(t){return!j(t)}function k(t){return t?Array.isArray(t)||v(t)?t.length:C(t)?Object.keys(t).length:0:0}function ve(t){return k(t)===0}function P(t){return t.replace(/(?:^\w|[A-Z]|\b\w)/g,(a,e)=>e==0?a.toLowerCase():a.toUpperCase()).replace(/\s+|_|-|\//g,"")}var K=class{translations;constructor(a){this.translations=a}getTranslation(a){return R(this.translations.get(a)||{})}},be=new g(""),O=new g("",{providedIn:"root",factory:()=>T}),T={defaultLang:"en",reRenderOnLangChange:!1,prodMode:!1,failedRetries:2,fallbackLang:[],availableLangs:[],missingHandler:{logMissingKey:!0,useFallbackTranslation:!1,allowEmpty:!1},flatten:{aot:!1},interpolation:["{{","}}"],scopes:{keepCasing:!1,autoPrefixKeys:!0}};function je(t={}){return y(d(d({},T),t),{missingHandler:d(d({},T.missingHandler),t.missingHandler),flatten:d(d({},T.flatten),t.flatten),scopes:d(d({},T.scopes),t.scopes)})}function _(t,a){return t&&(Object.prototype.hasOwnProperty.call(t,a)?t[a]:a.split(".").reduce((e,n)=>e?.[n],t))}function Ne(t,a,e){t=d({},t);let n=a.split("."),s=n.length-1;return n.reduce((r,i,o)=>(o===s?r[i]=e:r[i]=Array.isArray(r[i])?r[i].slice():d({},r[i]),r&&r[i]),t),t}var ye=new g(""),Ie=(()=>{class t{config=f(O,{optional:!0})??T;get interpolationMatcher(){return Fe(this.config)}transpile({value:e,params:n={},translation:s,key:r}){if(v(e)){let i,o=e;for(;(i=this.interpolationMatcher.exec(o))!==null;){let[l,c]=i;o=o.replace(l,()=>{let u=c.trim(),h=_(n,u);return $(h)?h:$(s[u])?this.transpile({params:n,translation:s,key:r,value:s[u]}):""})}return o}else n&&(C(e)?e=this.handleObject({value:e,params:n,translation:s,key:r}):Array.isArray(e)&&(e=this.handleArray({value:e,params:n,translation:s,key:r})));return e}handleObject({value:e,params:n={},translation:s,key:r}){let i=e;return Object.keys(n).forEach(o=>{let l=this.transpile({value:_(i,o),params:_(n,o),translation:s,key:r});i=Ne(i,o,l)}),i}handleArray(s){var r=s,{value:e}=r,n=q(r,["value"]);return e.map(i=>this.transpile(d({value:i},n)))}static \u0275fac=function(n){return new(n||t)};static \u0275prov=S({token:t,factory:t.\u0275fac})}return t})();function Fe(t){let[a,e]=t.interpolation;return new RegExp(`${a}([^${a}${e}]*?)${e}`,"g")}var me=new g(""),Ee=(()=>{class t{handle(e,n){if(n.missingHandler.logMissingKey&&!n.prodMode){let s=`Missing translation for '${e}'`;console.warn(`%c ${s}`,"font-size: 12px; color: red")}return e}static \u0275fac=function(n){return new(n||t)};static \u0275prov=S({token:t,factory:t.\u0275fac})}return t})(),Se=new g(""),xe=(()=>{class t{preSaveTranslation(e){return e}preSaveTranslationKey(e,n){return n}static \u0275fac=function(n){return new(n||t)};static \u0275prov=S({token:t,factory:t.\u0275fac})}return t})(),Te=new g(""),$e=(()=>{class t{userConfig;constructor(e){this.userConfig=e}getNextLangs(){let e=this.userConfig.fallbackLang;if(!e)throw new Error("When using the default fallback, a fallback language must be provided in the config!");return Array.isArray(e)?e:[e]}static \u0275fac=function(n){return new(n||t)(p(O))};static \u0275prov=S({token:t,factory:t.\u0275fac})}return t})();function Oe(t){let{path:a,inlineLoader:e,mainLoader:n,data:s}=t;if(e){let r=e[a];if(pe(r)===!1)throw`You're using an inline loader but didn't provide a loader for ${a}`;return e[a]().then(i=>i.default?i.default:i)}return n.getTranslation(a,s)}function ke({mainLoader:t,path:a,data:e,fallbackPath:n,inlineLoader:s}){return(n?[a,n]:[a]).map(i=>{let o=Oe({path:i,mainLoader:t,inlineLoader:s,data:e});return N(o).pipe(m(l=>({translation:l,lang:i})))})}function Le(t){let a={};function e(n,s){if(n===null)a[s]=null;else if(C(n))for(let[r,i]of Object.entries(n))e(i,s?`${s}.${r}`:r);else a[s]=n}return e(t,""),a}function Pe(t){let a={};for(let[e,n]of Object.entries(t)){let s=e.split("."),r=a;s.forEach((i,o)=>{o===s.length-1?r[i]=n:(r[i]??={},r=r[i])})}return a}function M(t){if(!t)return"";let a=t.split("/");return a.pop(),a.join("/")}function L(t){return t?t.split("/").pop():""}function _e(t,a){return Object.keys(t).reduce((e,n)=>(e[`${a}/${n}`]=t[n],e),{})}function Ae(t){return typeof t?.scope=="string"}function Ve(t){return t?.loader&&C(t.loader)}function we(t,a){return Ve(t)?_e(t.loader,a):void 0}function V(t){return{scope:M(t)||null,langName:L(t)}}var Ke;var He=(()=>{class t{loader;parser;missingHandler;interceptor;fallbackStrategy;langChanges$;translations=new Map;cache=new Map;firstFallbackLang;defaultLang="";availableLangs=[];isResolvedMissingOnce=!1;lang;failedLangs=new Set;events=new J;events$=this.events.asObservable();config;destroyRef=f(w);constructor(e,n,s,r,i,o){this.loader=e,this.parser=n,this.missingHandler=s,this.interceptor=r,this.fallbackStrategy=o,this.loader||(this.loader=new K(this.translations)),Ke=this,this.config=JSON.parse(JSON.stringify(i)),this.setAvailableLangs(this.config.availableLangs||[]),this.setFallbackLangForMissingTranslation(this.config),this.setDefaultLang(this.config.defaultLang),this.lang=new W(this.getDefaultLang()),this.langChanges$=this.lang.asObservable(),this.events$.subscribe(l=>{l.type==="translationLoadSuccess"&&l.wasFailure&&this.setActiveLang(l.payload.langName)}),this.destroyRef.onDestroy(()=>{this.lang.complete(),this.events.complete(),this.cache.clear()})}getDefaultLang(){return this.defaultLang}setDefaultLang(e){this.defaultLang=e}getActiveLang(){return this.lang.getValue()}setActiveLang(e){return this.parser.onLangChanged?.(e),this.lang.next(e),this.events.next({type:"langChanged",payload:V(e)}),this}setAvailableLangs(e){this.availableLangs=e}getAvailableLangs(){return this.availableLangs}load(e,n={}){let s=this.cache.get(e);if(s)return s;let r,i=this._isLangScoped(e),o;i&&(o=M(e));let l={path:e,mainLoader:this.loader,inlineLoader:n.inlineLoader,data:i?{scope:o}:void 0};if(this.useFallbackTranslation(e)){let u=i?`${o}/${this.firstFallbackLang}`:this.firstFallbackLang,h=ke(y(d({},l),{fallbackPath:u}));r=I(h)}else{let u=Oe(l);r=N(u)}let c=r.pipe(ee(this.config.failedRetries),se(u=>{if(Array.isArray(u)){u.forEach(h=>{this.handleSuccess(h.lang,h.translation),h.lang!==e&&this.cache.set(h.lang,R({}))});return}this.handleSuccess(e,u)}),Q(u=>(this.config.prodMode||console.error(`Error while trying to load "${e}"`,u),this.handleFailure(e,n))),te(1),D(this.destroyRef));return this.cache.set(e,c),c}translate(e,n={},s=this.getActiveLang()){if(!e)return e;let{scope:r,resolveLang:i}=this.resolveLangAndScope(s);if(Array.isArray(e))return e.map(c=>this.translate(this.config.scopes.autoPrefixKeys&&r?`${r}.${c}`:c,n,i));e=this.config.scopes.autoPrefixKeys&&r?`${r}.${e}`:e;let o=this.getTranslation(i),l=o[e];return l?this.parser.transpile({value:l,params:n,translation:o,key:e}):this._handleMissingKey(e,l,n)}selectTranslate(e,n,s,r=!1){let i,o=(c,u)=>this.load(c,u).pipe(m(()=>r?this.translateObject(e,n,c):this.translate(e,n,c)));if(j(s))return this.langChanges$.pipe(A(c=>o(c)));if(s=Array.isArray(s)?s[0]:s,Ae(s)){let c=s;s=c.scope,i=we(c,c.scope)}if(s=s,this.isLang(s)||this.isScopeWithLang(s))return o(s);let l=s;return this.langChanges$.pipe(A(c=>o(`${l}/${c}`,{inlineLoader:i})))}isScopeWithLang(e){return this.isLang(L(e))}translateObject(e,n={},s=this.getActiveLang()){if(v(e)||Array.isArray(e)){let{resolveLang:i,scope:o}=this.resolveLangAndScope(s);if(Array.isArray(e))return e.map(u=>this.translateObject(this.config.scopes.autoPrefixKeys&&o?`${o}.${u}`:u,n,i));let l=this.getTranslation(i);e=this.config.scopes.autoPrefixKeys&&o?`${o}.${e}`:e;let c=Pe(this.getObjectByKey(l,e));return ve(c)?this.translate(e,n,s):this.parser.transpile({value:c,params:n,translation:l,key:e})}let r=[];for(let[i,o]of this.getEntries(e))r.push(this.translateObject(i,o,s));return r}selectTranslateObject(e,n,s){if(v(e)||Array.isArray(e))return this.selectTranslate(e,n,s,!0);let[[r,i],...o]=this.getEntries(e);return this.selectTranslateObject(r,i,s).pipe(m(l=>{let c=[l];for(let[u,h]of o)c.push(this.translateObject(u,h,s));return c}))}getTranslation(e){if(e){if(this.isLang(e))return this.translations.get(e)||{};{let{scope:n,resolveLang:s}=this.resolveLangAndScope(e),r=this.translations.get(s)||{};return this.getObjectByKey(r,n)}}return this.translations}selectTranslation(e){let n=this.langChanges$;if(e){let s=L(e)!==e;this.isLang(e)||s?n=R(e):n=this.langChanges$.pipe(m(r=>`${e}/${r}`))}return n.pipe(A(s=>this.load(s).pipe(m(()=>this.getTranslation(s)))))}setTranslation(e,n=this.getActiveLang(),s={}){let i=d(d({},{merge:!0,emitChange:!0}),s),o=M(n),l=e;if(o){let Me=this.getMappedScope(o);l=Le({[Me]:e})}let c=o?L(n):n,u=d(d({},i.merge&&this.getTranslation(c)),l),h=this.config.flatten.aot?u:Le(u),Ce=this.interceptor.preSaveTranslation(h,c);this.translations.set(c,Ce),i.emitChange&&this.setActiveLang(this.getActiveLang())}setTranslationKey(e,n,s={}){let r=s.lang||this.getActiveLang(),i=this.interceptor.preSaveTranslationKey(e,n,r),o={[e]:i};this.setTranslation(o,r,y(d({},s),{merge:!0}))}setFallbackLangForMissingTranslation({fallbackLang:e}){let n=Array.isArray(e)?e[0]:e;e&&this.useFallbackTranslation(n)&&(this.firstFallbackLang=n)}_handleMissingKey(e,n,s){if(this.config.missingHandler.allowEmpty&&n==="")return"";if(!this.isResolvedMissingOnce&&this.useFallbackTranslation()){this.isResolvedMissingOnce=!0;let r=this.translate(e,s,this.firstFallbackLang);return this.isResolvedMissingOnce=!1,r}return this.missingHandler.handle(e,this.getMissingHandlerData(),s)}_isLangScoped(e){return this.getAvailableLangsIds().indexOf(e)===-1}isLang(e){return this.getAvailableLangsIds().indexOf(e)!==-1}_loadDependencies(e,n){let s=L(e);return this._isLangScoped(e)&&!this.isLoadedTranslation(s)?Z([this.load(s),this.load(e,{inlineLoader:n})]):this.load(e,{inlineLoader:n})}_completeScopeWithLang(e){return this._isLangScoped(e)&&!this.isLang(L(e))?`${e}/${this.getActiveLang()}`:e}_setScopeAlias(e,n){this.config.scopeMapping||(this.config.scopeMapping={}),this.config.scopeMapping[e]=n}isLoadedTranslation(e){return k(this.getTranslation(e))}getAvailableLangsIds(){let e=this.getAvailableLangs()[0];return v(e)?this.getAvailableLangs():this.getAvailableLangs().map(n=>n.id)}getMissingHandlerData(){return y(d({},this.config),{activeLang:this.getActiveLang(),availableLangs:this.availableLangs,defaultLang:this.defaultLang})}useFallbackTranslation(e){return this.config.missingHandler.useFallbackTranslation&&e!==this.firstFallbackLang}handleSuccess(e,n){this.setTranslation(n,e,{emitChange:!1}),this.events.next({wasFailure:!!this.failedLangs.size,type:"translationLoadSuccess",payload:V(e)}),this.failedLangs.forEach(s=>this.cache.delete(s)),this.failedLangs.clear()}handleFailure(e,n){j(n.failedCounter)&&(n.failedCounter=0,n.fallbackLangs||(n.fallbackLangs=this.fallbackStrategy.getNextLangs(e)));let s=e.split("/"),i=n.fallbackLangs[n.failedCounter];if(this.failedLangs.add(e),this.cache.has(i))return this.handleSuccess(i,this.getTranslation(i)),Y;let o=i===s[s.length-1];if(!i||o){let c="Unable to load translation and all the fallback languages";throw s.length>1&&(c+=", did you misspelled the scope name?"),new Error(c)}let l=i;return s.length>1&&(s[s.length-1]=i,l=s.join("/")),n.failedCounter++,this.events.next({type:"translationLoadFailure",payload:V(e)}),this.load(l,n)}getMappedScope(e){let{scopeMapping:n={},scopes:s={keepCasing:!1}}=this.config;return n[e]||(s.keepCasing?e:P(e))}resolveLangAndScope(e){let n=e,s;if(this._isLangScoped(e)){let r=L(e),i=this.isLang(r);n=i?r:this.getActiveLang(),s=this.getMappedScope(i?M(e):e)}return{scope:s,resolveLang:n}}getObjectByKey(e,n){let s={},r=`${n}.`;for(let i in e)i.startsWith(r)&&(s[i.replace(r,"")]=e[i]);return s}getEntries(e){return e instanceof Map?e.entries():Object.entries(e)}static \u0275fac=function(n){return new(n||t)(p(be,8),p(ye),p(me),p(Se),p(O),p(Te))};static \u0275prov=S({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})(),Be=(()=>{class t{html;static \u0275fac=function(n){return new(n||t)};static \u0275cmp=ue({type:t,selectors:[["ng-component"]],inputs:{html:"html"},decls:1,vars:1,consts:[[1,"transloco-loader-template",3,"innerHTML"]],template:function(n,s){n&1&&ge(0,"div",0),n&2&&he("innerHTML",s.html,oe)},encapsulation:2})}return t})(),H=class{view;vcr;constructor(a,e){this.view=a,this.vcr=e}attachView(){if(this.view instanceof E)this.vcr.createEmbeddedView(this.view);else if(v(this.view)){let a=this.vcr.createComponent(Be);a.instance.html=this.view,a.hostView.detectChanges()}else this.vcr.createComponent(this.view)}detachView(){this.vcr.clear()}},Ge=new g(""),ze=new g(""),qe=new g("");function B(t,a,e="|"){if(v(t)){let n=t.split(e),s=n.pop();return s===a?[!0,n.toString()]:[!1,s]}return[!1,""]}function Ue(t,a){let[e]=B(a,"static");return e?!1:!!t.config.reRenderOnLangChange}function Je(t){return t?a=>a:X(1)}var G=class{initialized=!1;resolve({inline:a,provider:e,active:n}){let s=n;if(this.initialized)return s=n,s;if(e){let[,r]=B(e,"static");s=r}if(a){let[,r]=B(a,"static");s=r}return this.initialized=!0,s}resolveLangBasedOnScope(a){return M(a)?L(a):a}resolveLangPath(a,e){return e?`${e}/${a}`:a}},z=class{service;constructor(a){this.service=a}resolve(a){let{inline:e,provider:n}=a;if(e)return e;if(n){if(Ae(n)){let{scope:s,alias:r=this.service.config.scopes.keepCasing?s:P(s)}=n;return this.service._setScopeAlias(s,r),s}return n}}},Pt=(()=>{class t{destroyRef=f(w);service=f(He);tpl=f(E,{optional:!0});providerLang=f(Ge,{optional:!0});providerScope=f(qe,{optional:!0});providedLoadingTpl=f(ze,{optional:!0});cdr=f(x);host=f(ae);vcr=f(le);renderer=f(ce);view;memo=new Map;key;params={};inlineScope;inlineRead;prefix;inlineLang;inlineTpl;currentLang;loaderTplHandler;initialized=!1;path;langResolver=new G;scopeResolver=new z(this.service);strategy=this.tpl===null?"attribute":"structural";static ngTemplateContextGuard(e,n){return!0}ngOnInit(){let e=Ue(this.service,this.providerLang||this.inlineLang);if(this.service.langChanges$.pipe(A(n=>{let s=this.langResolver.resolve({inline:this.inlineLang,provider:this.providerLang,active:n});return Array.isArray(this.providerScope)?I(this.providerScope.map(r=>this.resolveScope(s,r))):this.resolveScope(s,this.providerScope)}),Je(e),D(this.destroyRef)).subscribe(()=>{this.currentLang=this.langResolver.resolveLangBasedOnScope(this.path),this.strategy==="attribute"?this.attributeStrategy():this.structuralStrategy(this.currentLang,this.prefix||this.inlineRead),this.cdr.markForCheck(),this.initialized=!0}),!this.initialized){let n=this.resolveLoadingContent();n&&(this.loaderTplHandler=new H(n,this.vcr),this.loaderTplHandler.attachView())}}ngOnChanges(e){this.strategy==="attribute"&&Object.keys(e).some(s=>!e[s].firstChange)&&this.attributeStrategy()}attributeStrategy(){this.detachLoader(),this.renderer.setProperty(this.host.nativeElement,"innerText",this.service.translate(this.key,this.params,this.currentLang))}structuralStrategy(e,n){this.memo.clear();let s=this.getTranslateFn(e,n);this.view?(this.view.context.$implicit=s,this.view.context.currentLang=this.currentLang):(this.detachLoader(),this.view=this.vcr.createEmbeddedView(this.tpl,{$implicit:s,currentLang:this.currentLang}))}getTranslateFn(e,n){return(s,r)=>{let i=n?`${n}.${s}`:s,o=r?`${i}${JSON.stringify(r)}`:i;return this.memo.has(o)||this.memo.set(o,this.service.translate(i,r,e)),this.memo.get(o)}}resolveLoadingContent(){return this.inlineTpl||this.providedLoadingTpl}ngOnDestroy(){this.memo.clear()}detachLoader(){this.loaderTplHandler?.detachView()}resolveScope(e,n){let s=this.scopeResolver.resolve({inline:this.inlineScope,provider:n});this.path=this.langResolver.resolveLangPath(e,s);let r=we(n,s);return this.service._loadDependencies(this.path,r)}static \u0275fac=function(n){return new(n||t)};static \u0275dir=fe({type:t,selectors:[["","transloco",""]],inputs:{key:[0,"transloco","key"],params:[0,"translocoParams","params"],inlineScope:[0,"translocoScope","inlineScope"],inlineRead:[0,"translocoRead","inlineRead"],prefix:[0,"translocoPrefix","prefix"],inlineLang:[0,"translocoLang","inlineLang"],inlineTpl:[0,"translocoLoadingTpl","inlineTpl"]},features:[ie]})}return t})();var _t=(()=>{class t{static \u0275fac=function(n){return new(n||t)};static \u0275mod=de({type:t});static \u0275inj=re({})}return t})();function Vt(t){let a=[Ze(Ie),Xe(Ee),et(xe),Qe($e)];return t.config&&a.push(We(t.config)),t.loader&&a.push(Ye(t.loader)),a}function We(t){return b([{provide:O,useValue:je(t)}])}function Ye(t){return b([{provide:be,useClass:t}])}function Ze(t){return b([{provide:ye,useClass:t,deps:[O]}])}function Qe(t){return b([{provide:Te,useClass:t,deps:[O]}])}function Xe(t){return b([{provide:me,useClass:t}])}function et(t){return b([{provide:Se,useClass:t}])}export{He as a,Pt as b,_t as c,Vt as d};
